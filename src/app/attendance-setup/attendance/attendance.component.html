<ion-card>
  <ion-card-header style="border-radius: 2px;box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.04);">
    <div class="fullContainer">
      <ion-item-group style="display: flex;">
        <div class="left" style="min-width: fit-content;">
          <img src="assets/icon/attendance/icon_time_attendance.png" style="width:35px;height:33px">
        </div>
        <div class="right">
          <ion-card-subtitle style="color: #43425d;opacity: 0.8;font-weight: bold;font-size: 13px;">Time Attendance
            Management
          </ion-card-subtitle>
          <ion-card-subtitle class="subtitle" style="font-size: 12px;">
            Create the attendance profile and assign employee according configuration of working place details</ion-card-subtitle>
        </div>
      </ion-item-group>
      <ion-item-group style="margin-right: 33px; margin-left: auto; padding-left: 5px; line-height: initial;">
        <div style="right: 75px;top: 25px;">
          <p
            style="margin-top: 16px;opacity: 0.8;font-size: 12px;font-weight: bold;color: #43425d;display: inline-block;padding-right: 10px;">
            Edit
            Mode: {{mode}}</p>
          <div style="display: inline-block;position: absolute;margin-top: 12px;">
            <ion-toggle class="toggleButton" mode="ios" color="secondary" (ionChange)="toggleMode($event)">
            </ion-toggle>
          </div>
        </div>
      </ion-item-group>
    </div>
  </ion-card-header>
  <div style="width: 100%; height:100%; text-align: center; margin-top: -30px" *ngIf="showSpinner">
    <app-spinner></app-spinner>
  </div>
  <div style="background: #f0f0f7;height: 100%;position: absolute;width: 100%;">
    <div class="cardContent">
      <ion-card-content style="max-height: 100%;height: 100%;">
        <div class="row" style="flex-wrap: wrap; overflow-y: auto;">
          <div class="role" style="flex: 1; min-width: 200px;">
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row>
                <ion-col size="9" style="font-size: 12px;white-space: nowrap;
                                  text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                  PROFILE DETAILS</ion-col>
                <ion-col align-self-center style="text-align: right;">
                  <ion-icon class="addIcon" name="add-circle-outline" *ngIf="mode == 'ON'"
                    (click)="menuOpen = true;_sharedService.menu.open('createNewRoleDetails'); _sharedService.menu.enable(true, 'createNewRoleDetails'); _sharedService.menu.enable(false, 'editRoleDetails');">
                  </ion-icon>
                </ion-col>
              </ion-row>
            </div>
            <div style="overflow-y: auto;height: calc(100% - 62px);">
              <ng-container *ngIf="mode == 'OFF'">
                <ion-row *ngFor="let role of roleList; let i=index" style="padding-left: 5px;">
                  <ion-col size="9.5" style="overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">
                    <p class="textHover"
                      style="cursor: pointer;font-size: 12px;font-weight: bold;overflow: hidden;white-space: pre-line;text-overflow: ellipsis;margin-bottom: 0;"
                      [ngClass]="{
                                          'textColor': clickedIndex === i, 'oriColor': clickedIndex !== i}"
                      (click)="selectedProfile(role, i)">
                      {{role.code}}
                    </p>
                    <p
                      style="font-style: italic;font-weight: 600;padding-bottom: 5px;font-size: 11px;color: #4d4f5c;padding: 0;overflow: hidden;white-space: pre-line;text-overflow: ellipsis;">
                      {{role.description}}
                    </p>
                    <div
                      style="font-size: 10px;color: #4d4f5c;padding: 0;overflow: hidden;white-space: pre-line;text-overflow: ellipsis;">
                      Assigned Employee No.: <p
                        style="display: inline;font-size: 10px;color: #4d4f5c;padding: 0;font-weight: bold;">
                        {{role.total_employee_attach}}</p>
                    </div>
                  </ion-col>
                  <ion-col *ngIf="mode == 'OFF'" style="text-align: right;padding-right: 15px; display: flex;align-items: center;
                                      justify-content: center; ">
                  </ion-col>
                  <!-- <ion-col align-self-center *ngIf="mode == 'ON'" style="text-align: right;padding-right: 15px; display: flex; flex-flow: row
                                      wrap; align-items: center;">
                    <img src="assets/icon/leave_setup/icon_edit@3x.png"
                      style="width: 11px;height:11px;display: inline-block;cursor: pointer;"
                      (click)="menuOpen = true;selectedProfile(role, i);editRoleName.patchValue(role.code);editRoleDescription.patchValue(role.description);_sharedService.menu.enable(true, 'editRoleDetails'); _sharedService.menu.open('editRoleDetails'); _sharedService.menu.enable(false, 'createNewRoleDetails');"
                      [ngClass]="{ 
                                          'imgFilter': clickedIndex !== i && clickedIndex !== null, 'imgColor': clickedIndex === i, 'showCursor':clickedIndex === null }">
                    &nbsp;&nbsp;
                    <img src="assets/icon/leave_setup/icon_trash@3x.png"
                      style="width: 11px;height:11px;display: inline-block;cursor: pointer;"
                      (click)="delete(role.role_guid, role.code)">
                  </ion-col> -->
                  <ion-item class="divider" lines="full"></ion-item>
                </ion-row>
              </ng-container>

              <ng-container *ngIf="mode == 'ON'">
                <section class="my-dropzone scrollable" dndDropzone dndDragoverClass="custom-drag-over"
                  (dndDrop)="onDropped($event, role)" [dndDisableIf]="i==clickedIndex"
                  *ngFor="let role of roleList; let i=index">
                  <ion-row class="sectionRow">
                    <ion-col size="9.5" style="overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">
                      <p class="textHover"
                        style="cursor: pointer;font-size: 12px;font-weight: bold;overflow: hidden;white-space: pre-line;text-overflow: ellipsis;margin-bottom: 0;"
                        [ngClass]="{
                                          'textColor': clickedIndex === i, 'oriColor': clickedIndex !== i}"
                        (click)="selectedProfile(role, i)">
                        {{role.code}}
                      </p>
                      <p
                        style="font-style: italic;font-weight: 600;padding-bottom: 5px;font-size: 11px;color: #4d4f5c;padding: 0;overflow: hidden;white-space: pre-line;text-overflow: ellipsis;">
                        {{role.description}}
                      </p>
                      <div style="font-size: 10px;color: #4d4f5c;padding: 0;overflow:
                                              hidden;white-space: pre-line;text-overflow: ellipsis;">
                        Assigned Employee No.: <p
                          style="display: inline;font-size: 10px;color: #4d4f5c;padding: 0;font-weight: bold;">
                          {{role.total_employee_attach}}</p>
                      </div>
                    </ion-col>
                    <ion-col align-self-center *ngIf="mode == 'ON'"
                      style="text-align: right;padding-right: 15px;display: flex; flex-flow: row wrap; align-items: center;">
                      <img src="assets/icon/leave_setup/icon_edit@3x.png"
                        style="width: 11px;height:11px;display: inline-block;cursor: pointer;"
                        (click)="menuOpen = true;selectedProfile(role, i);editRoleName.patchValue(role.code);editRoleDescription.patchValue(role.description);_sharedService.menu.enable(true, 'editRoleDetails'); _sharedService.menu.open('editRoleDetails'); _sharedService.menu.enable(false, 'createNewRoleDetails');"
                        [ngClass]="{
                                          'imgFilter': clickedIndex !== i && clickedIndex !== null, 'imgColor': clickedIndex === i, 'showCursor':clickedIndex === null }">
                      &nbsp;&nbsp;
                      <img src="assets/icon/leave_setup/icon_trash@3x.png"
                        style="width: 11px;height:11px;display: inline-block;cursor: pointer;"
                        (click)="delete(role.role_guid, role.code)">
                    </ion-col>
                  </ion-row>
                </section>
              </ng-container>
            </div>
          </div>
          <div class="assigned" style="flex: 1; min-width: 230px;">
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row style="flex-flow: nowrap">
                <ion-col *ngIf="mode == 'ON'"
                  style="max-width: 28px;align-self: center; min-width: fit-content; display: flex;">
                  <ion-checkbox mode="ios" style="width: 16px; height: 16px; margin-top: 1px;  margin-right: 5px;"
                    *ngIf="mode == 'ON'" [(ngModel)]="roleListCheckAll" [indeterminate]="roleListIsIndeterminate"
                    (click)="checkAllRoleListAssignedEmployees()">
                  </ion-checkbox>
                  <div *ngIf="roleListIsIndeterminate || roleListCheckAll">
                    <ion-icon name="more"
                      style="width: 18px; height: 18px; color: #7069d8; font-size: 16px; cursor: pointer;" mat-button
                      [matMenuTriggerFor]="menu">
                    </ion-icon>
                    <mat-menu #menu="matMenu">
                      <ion-label style=" background: #f5f6fa;white-space: pre-line;text-overflow:
                                              ellipsis;color: #4d4f5c;font-size:11px; padding: 15px;display: flex;">
                        Move selected to: </ion-label>
                      <ion-list>
                        <div mat-menu-item
                          style="white-space: pre-line;text-overflow: ellipsis;color: #4d4f5c;font-size:11px;"
                          *ngFor="let list of roleList; let i=index" (click)="reassignToOtherRoles(list)">{{list.code}}
                        </div>
                      </ion-list>
                    </mat-menu>
                  </div>
                </ion-col>
                <ion-col style="font-size: 12px;white-space: nowrap;
                                  text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                  ASSIGNED EMPLOYEE</ion-col>
              </ion-row>
            </div>
            <div style="overflow-y: auto;height: calc(100% - 62px);" *ngIf="mode == 'OFF'">
              <ion-row *ngFor="let item of assignedNameList; let i =index" style="width: 100%;padding-left: 10px;">
                <ion-col align-self-center size="9" style="padding-top: 0;padding-bottom: 0;">
                  <p style="overflow: hidden;white-space: pre-line;text-overflow: ellipsis;color: #4d4f5c;font-size:11px;padding-top: 13px;
                                      padding-bottom: 13px;">
                    {{item.fullname}}</p>
                </ion-col>
                <ion-item class="divider" lines="full">
                </ion-item>
              </ion-row>
            </div>
            <div style="overflow-y: auto;height: calc(100% - 62px);" *ngIf="mode == 'ON'">
              <mat-card *ngFor="let draggable of assignedNameList" [dndDraggable]="draggable.content"
                [dndEffectAllowed]="draggable.effectAllowed" [dndDisableIf]="draggable.disable"
                style="margin: 5px;border-radius: 3px;box-shadow: 0 3px 6px 0 rgba(77, 77, 77, 0.16);">
                <div style="float: left;padding-right: 15px;cursor: move; display: flex;">
                  <ion-checkbox mode="ios" style="height: 16px; width: 16px; margin-right: 10px;"
                    [(ngModel)]="draggable.isChecked" (ionChange)="checkRoleListAssignedEmployeeEvent()">
                  </ion-checkbox>
                  <img src="assets/icon/leave_setup/icon_reorder@3x.png" style="width: 16px;height: 16px;"
                    *ngIf="draggable.handle" dndHandle>
                </div>
                <p [hidden]="!draggable.handle" style="color: #4d4f5c;font-size:11px;display: flex;">
                  {{draggable.content}}</p>
              </mat-card>
            </div>
          </div>
          <div class="leave">
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 7px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row>
                <ion-col
                  style="font-size: 12px;white-space: nowrap;
                                                    text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;padding-top: 0;">
                  OFFICE
                  <p style="font-style: italic;
                  font-size: 10px;
                  color: #808495;
                  opacity:0.8;
                  padding: 0;
                  overflow: hidden;
                  white-space: nowrap;
                  text-overflow: ellipsis;">Working at the office</p>
                </ion-col>
                <ion-col style="text-align: right;">
                  <p style="opacity: 0.8;font-size: 11px;font-weight: bold;color: #43425d;
                    margin-right: 10px;top: 10px;right: 35px;position: absolute;">
                    Enable</p>
                  <div style="display: inline-flex">
                    <ion-toggle class="enableButton" mode="ios" color="secondary">
                    </ion-toggle>
                  </div>
                </ion-col>
              </ion-row>
            </div>
            <div style="overflow-y: auto;height: calc(100% - 62px);">
              <div class="leaveSetup">
                <ion-list lines="none" style="padding-top: 0;">
                  <ion-item class="ionItem">
                    <ion-label>View client list</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View project selection</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View contract selection</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View activity list</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>Enable geofence filter</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                </ion-list>
              </div>
              <div
                style="font-size: 12px;width:100%;background: #f5f6fa;padding: 7px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
                <ion-row>
                  <ion-col
                    style="font-size: 12px;white-space: nowrap;
                                                    text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;padding-top: 0;">
                    SITE <p style="font-style: italic;
                    font-size: 10px;
                    color: #808495;
                    opacity:0.8;
                    padding: 0;
                    overflow: hidden;
                    white-space: nowrap;
                    text-overflow: ellipsis;">On site job at client place</p>
                  </ion-col>
                  <ion-col style="text-align: right;">
                    <p style="opacity: 0.8;font-size: 11px;font-weight: bold;color: #43425d;
                      margin-right: 10px;top: 10px;right: 35px;position: absolute;">
                      Enable</p>
                    <div style="display: inline-flex">
                      <ion-toggle class="enableButton" mode="ios" color="secondary">
                      </ion-toggle>
                    </div>
                  </ion-col>
                </ion-row>
              </div>
              <div class="leaveManagement">
                <ion-list lines="none" class="ionItem"
                  style="padding-bottom: 10px;padding-top: 0px;white-space: nowrap;">
                  <ion-item class="ionItem">
                    <ion-label>View client list</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View project selection</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View contract selection</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View activity list</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>Enable geofence filter</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                </ion-list>
              </div>
            </div>
          </div>

          <div class="manage">
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 7px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row>
                <ion-col style="font-size: 12px;white-space: nowrap;
                        text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;padding-top: 0;">
                  HOME <p style="font-style: italic;
                  font-size: 10px;
                  color: #808495;
                  opacity:0.8;
                  padding: 0;
                  overflow: hidden;
                  white-space: nowrap;
                  text-overflow: ellipsis;">Working from home</p>
                </ion-col>
                <ion-col style="text-align: right;">
                  <p style="opacity: 0.8;font-size: 11px;font-weight: bold;color: #43425d;
                    margin-right: 10px;top: 10px;right: 35px;position: absolute;">
                    Enable</p>
                  <div style="display: inline-flex">
                    <ion-toggle class="enableButton" mode="ios" color="secondary">
                    </ion-toggle>
                  </div>
                </ion-col>
              </ion-row>
            </div>
            <div style="overflow-y: auto;height: calc(100% - 62px);">
              <div class="profileManagement">
                <ion-list lines="none" class="ionItem"
                  style="padding-bottom: 10px;padding-top: 0px;white-space: nowrap;">
                  <ion-item class="ionItem">
                    <ion-label>View client list</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View project selection</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View contract selection</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View activity list</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>Enable geofence filter</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                </ion-list>


              </div>
              <div
                style="font-size: 12px;width:100%;background: #f5f6fa;padding: 7px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
                <ion-row>
                  <ion-col style="font-size: 12px;white-space: nowrap;
                    text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;padding-top: 0;">
                    OTHERS<p style="font-style: italic;
                    font-size: 10px;
                    color: #808495;
                    opacity:0.8;
                    padding: 0;
                    overflow: hidden;
                    white-space: nowrap;
                    text-overflow: ellipsis;">Working outside, meeting, etc</p>
                  </ion-col>
                  <ion-col style="text-align: right;">
                    <p style="opacity: 0.8;font-size: 11px;font-weight: bold;color: #43425d;
                      margin-right: 10px;top: 10px;right: 35px;position: absolute;">
                      Enable</p>
                    <div style="display: inline-flex">
                      <ion-toggle class="enableButton" mode="ios" color="secondary">
                      </ion-toggle>
                    </div>
                  </ion-col>
                </ion-row>
              </div>

              <div class="calendarView">
                <ion-list lines="none" class="ionItem" style="padding-bottom: 10px;
                padding-top: 0px;white-space: nowrap;">
                  <ion-item class="ionItem">
                    <ion-label>View client list</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View project selection</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View contract selection</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>View activity list</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                  <ion-item class="ionItem">
                    <ion-label>Enable geofence filter</ion-label>
                    <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [disabled]="editMode == 'OFF'"
                      (ionChange)="checkEvent(leaveSetupKey, 0)">
                    </ion-checkbox>
                  </ion-item>
                </ion-list>
              </div>
            </div>
          </div>

        </div>
      </ion-card-content>
    </div>
  </div>
</ion-card>